{% extends "layouts/layout.njk" %}

{% block scripts %}
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="/build/assets/js/jSignature.js"></script>
    <script>
        var signaturePad = null;
        $(document).ready(function() {
            signaturePad = $("#applicant_signature_pad");
            signaturePad.jSignature({width: 600, height: 200});
        })
    </script>
{% endblock %}

{% block content %}

    <h1>{{ __('section2.title') }}</h1>

    <p>{{ __('section2.preamble') | safe }}</p>

    <form action="{{ route('consent.store') }}" method="post">
        <input type="hidden" name="_csrf" value="{{ _csrf }}">

        {{ medicalConsent('consent', { 'consent':'section2.i_consent','no_consent':'section2.i_dont_consent'}, data.consent, 'section2.consent_preamble', errors, {required: true}) }}

        <p>{{ __('section2.delay_warning_preamble') }}</p>
        <ul>
            <li>{{ __('section2.delay_warning_1') }}</li>
            <li>{{ __('section2.delay_warning_2') }}</li>
            <li>{{ __('section2.delay_warning_3') }}</li>
        </ul>

        <div class="relative w-3-4 border-2 border-black">
            <div id="applicant_signature_clear" class="bottom-0 w-full text-right pr-4 pt-4 leading-none">
                <a onclick="signaturePad.jSignature('clear')" class="no-underline text-gray-500">Clear</a>
            </div>
            <div id="applicant_signature_pad" class="overflow-hidden"></div>
            <div id="applicant_signature_line" class="absolute bottom-0 p-4 pointer-events-none w-full">
                <div class="border-b border-gray-500 text-gray-500">x</div>
            </div>
        </div>

        {{ textInput('signature', 'section2.form.signature') }}

        <fieldset>
            <legend>{{__('section2.witness_legend')}}</legend>
            <p> {{__('section2.witness_preamble')}} </p>
            {{ textInput('witnessFirst', 'section2.form.witness_first') }}
            {{ textInput('witnessMiddle', 'section2.form.witness_middle') }}
            {{ textInput('witnessLast', 'section2.form.witness_last') }}
            {{ textInput('witnessPhone', 'section2.form.witness_phone') }}
            {{ textInput('witnessSignature', 'section2.form.witness_signature') }}
        </fieldset>

        <p>{{ __('section2.consent_valid_period') | safe }}</p>

        {{ formButtons() }}
    </form>

{% endblock %}
