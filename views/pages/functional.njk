{% extends "layouts/layout.njk" %}

{#
  - `name`: field name
  - `label`: text for the label
  - `attributes`: object of optional attributes: id, class, hint, divClasses, autocomplete
#}
{% if errors %}
    {% set firstError = errors.keys()[0] %}
{% endif %}

{% macro textAreaSafeHint(name, label, attributes) %}
    <div class="{{ 'has-error' if errors and errors[name] }} {{ attributes.divClasses }}">
        <label for="{{ name }}" id="{{ name }}__label">
        {% if attributes.required %}
                <span aria-hidden="true" class="required">*</span>
        {% endif %}
        {{ label }}
        {% if attributes.required %}
            <span class="required">{{ __("required")}}</span>
        {% endif %}
        </label>
        {% if attributes.hint %}
            <span class="form-message">{{ attributes.hint | safe }}</span>
        {% endif %}
        {% if errors and errors[name] %}
            {{ validationMessage(errors[name], name) }}
        {% endif %}
        <textarea class="{{ attributes.class if attributes.class else "w-3-4" }}" id="{{ attributes.id if attributes.id else name }}" {% if errors and errors[name] %} aria-describedby="{{ name + '-error' }}" aria-invalid="true" {% endif %} {% if errors and firstError === name %} autofocus="true" {% endif %} name="{{ name }}">{{ attributes.value if attributes.value else data[name] }}</textarea>
    </div>
{% endmacro %}


{% block content %}

  {{ backButton('dashboard') }}
  
  <h1>{{ __('functional.title') }}<br/> <span class="text-base">{{ __('patient')}} {{ patientName(data) }}</span></h1>

  <form method="post" actioh="{{ route('functional.store') }}">
    {{ textAreaSafeHint('limitations', __('functional.limitations', patientName(data)), { required: true, hint: __('functional.limitations_hint')})}}
    {{ textAreaRaw('plannedTreatments', __('functional.plannedTreatments', patientName(data)), { required: true})}}
    <div class="md:flex">
    <div class="md:flex-1 md:w-1/2 md:mr-4">
      {{ textInputRaw('weight', __('functional.weight', patientName(data)), { required: true })}}
      </div>
      <div class="md:flex-1 md:w-1/2 md:ml-4">
      {{ textInputRaw('height', __('functional.height', patientName(data)), { required: true })}}
      </div>
    </div>
    <div class="buttons">
        <div class="buttons--left">
            <button type="submit" class="w-1/3">{{ __('functional.save_data') }}</button>
        </div>
    </div>
  </form>

{% endblock %}
